# Comprehensive Power System Network for EMTP Simulation
# Format: [SECTION] followed by data lines
# Coordinates are in meters for visualization purposes

[NODES]
# Format: NodeName X_coord Y_coord
# 345kV Transmission Bus
MAINBUS1 0.0 0.0
MAINBUS2 200.0 0.0
MAINBUS3 400.0 0.0
MAINBUS4 600.0 0.0
MAINBUS5 600.0 200.0
MAINBUS6 400.0 200.0
MAINBUS7 200.0 200.0
MAINBUS8 0.0 200.0

# 138kV Distribution Bus
DISTBUS1 50.0 50.0
DISTBUS2 250.0 50.0
DISTBUS3 450.0 50.0
DISTBUS4 550.0 250.0
DISTBUS5 350.0 250.0
DISTBUS6 150.0 250.0

# 34.5kV Collection Bus
WINDCOL1 100.0 100.0
WINDCOL2 300.0 100.0
SOLARCOL1 500.0 100.0
SOLARCOL2 500.0 300.0

# 690V Generation Bus for Wind
WINDGEN1A 75.0 125.0
WINDGEN1B 100.0 125.0
WINDGEN1C 125.0 125.0
WINDGEN2A 275.0 125.0
WINDGEN2B 300.0 125.0
WINDGEN2C 325.0 125.0

# 480V Generation Bus for Solar
SOLARGEN1A 475.0 125.0
SOLARGEN1B 500.0 125.0
SOLARGEN1C 525.0 125.0
SOLARGEN2A 475.0 325.0
SOLARGEN2B 500.0 325.0
SOLARGEN2C 525.0 325.0

# Energy Storage and STATCOM Connection Points
STORAGE1 150.0 150.0
STORAGE2 450.0 150.0
STATCOM1 250.0 150.0
STATCOM2 350.0 150.0

[BRANCHES]
# Format: Type FromNode ToNode Name Parameters...
# Transmission Lines: R(ohm) L(H) C(F) Length(km)
LINE MAINBUS1 MAINBUS2 LINE1_2 1.20 0.0133 9.55e-9 50.0
LINE MAINBUS2 MAINBUS3 LINE2_3 1.35 0.0142 1.02e-8 60.0
LINE MAINBUS3 MAINBUS4 LINE3_4 1.15 0.0128 9.10e-9 45.0
LINE MAINBUS4 MAINBUS5 LINE4_5 0.85 0.0120 8.40e-9 30.0
LINE MAINBUS5 MAINBUS6 LINE5_6 1.10 0.0125 8.75e-9 40.0
LINE MAINBUS6 MAINBUS7 LINE6_7 1.30 0.0138 9.80e-9 55.0
LINE MAINBUS7 MAINBUS8 LINE7_8 1.05 0.0122 8.60e-9 38.0
LINE MAINBUS8 MAINBUS1 LINE8_1 1.25 0.0135 9.65e-9 52.0
LINE MAINBUS2 MAINBUS7 LINE2_7 1.50 0.0150 1.08e-8 65.0
LINE MAINBUS3 MAINBUS6 LINE3_6 1.40 0.0145 1.05e-8 62.0

# Distribution Lines: R(ohm) L(H) C(F) Length(km)
LINE DISTBUS1 DISTBUS2 DIST1_2 2.50 0.0220 5.85e-9 15.0
LINE DISTBUS2 DISTBUS3 DIST2_3 2.65 0.0235 6.15e-9 18.0
LINE DISTBUS3 DISTBUS4 DIST3_4 2.80 0.0245 6.35e-9 20.0
LINE DISTBUS4 DISTBUS5 DIST4_5 2.40 0.0210 5.65e-9 14.0
LINE DISTBUS5 DISTBUS6 DIST5_6 2.55 0.0225 5.95e-9 16.0
LINE DISTBUS6 DISTBUS1 DIST6_1 2.70 0.0240 6.25e-9 19.0

# Collection System Lines: R(ohm) L(H) C(F) Length(km)
LINE WINDCOL1 WINDGEN1A WCOL1_GEN1A 0.45 0.0045 2.50e-9 1.5
LINE WINDCOL1 WINDGEN1B WCOL1_GEN1B 0.48 0.0048 2.60e-9 1.6
LINE WINDCOL1 WINDGEN1C WCOL1_GEN1C 0.51 0.0051 2.70e-9 1.7
LINE WINDCOL2 WINDGEN2A WCOL2_GEN2A 0.42 0.0042 2.40e-9 1.4
LINE WINDCOL2 WINDGEN2B WCOL2_GEN2B 0.45 0.0045 2.50e-9 1.5
LINE WINDCOL2 WINDGEN2C WCOL2_GEN2C 0.48 0.0048 2.60e-9 1.6
LINE SOLARCOL1 SOLARGEN1A SCOL1_GEN1A 0.36 0.0036 2.20e-9 1.2
LINE SOLARCOL1 SOLARGEN1B SCOL1_GEN1B 0.39 0.0039 2.30e-9 1.3
LINE SOLARCOL1 SOLARGEN1C SCOL1_GEN1C 0.42 0.0042 2.40e-9 1.4
LINE SOLARCOL2 SOLARGEN2A SCOL2_GEN2A 0.33 0.0033 2.10e-9 1.1
LINE SOLARCOL2 SOLARGEN2B SCOL2_GEN2B 0.36 0.0036 2.20e-9 1.2
LINE SOLARCOL2 SOLARGEN2C SCOL2_GEN2C 0.39 0.0039 2.30e-9 1.3

# Transformers: Primary voltage (kV) Secondary voltage (kV) Rating (MVA) Leakage reactance (%) Saturation flux (p.u.) Core loss resistance (p.u.)
TRANSFORMER MAINBUS1 DISTBUS1 TR_MAIN1_DIST1 345.0 138.0 250.0 8.0 1.2 0.005
TRANSFORMER MAINBUS2 DISTBUS2 TR_MAIN2_DIST2 345.0 138.0 200.0 7.5 1.25 0.0045
TRANSFORMER MAINBUS3 DISTBUS3 TR_MAIN3_DIST3 345.0 138.0 300.0 8.5 1.18 0.0055
TRANSFORMER MAINBUS5 DISTBUS4 TR_MAIN5_DIST4 345.0 138.0 180.0 7.0 1.3 0.004
TRANSFORMER MAINBUS6 DISTBUS5 TR_MAIN6_DIST5 345.0 138.0 220.0 7.8 1.22 0.0048
TRANSFORMER MAINBUS7 DISTBUS6 TR_MAIN7_DIST6 345.0 138.0 270.0 8.2 1.2 0.005

# Wind Farm Transformers with Magnetization Parameters
TRANSFORMER DISTBUS1 WINDCOL1 TR_DIST1_WCOL1 138.0 34.5 75.0 6.0 1.35 0.006
TRANSFORMER DISTBUS2 WINDCOL2 TR_DIST2_WCOL2 138.0 34.5 90.0 6.2 1.3 0.0058

# Solar Farm Transformers with Magnetization Parameters
TRANSFORMER DISTBUS3 SOLARCOL1 TR_DIST3_SCOL1 138.0 34.5 60.0 5.8 1.4 0.0062
TRANSFORMER DISTBUS4 SOLARCOL2 TR_DIST4_SCOL2 138.0 34.5 50.0 5.5 1.38 0.0065

# Wind Turbine Step-up Transformers
TRANSFORMER WINDCOL1 WINDGEN1A TR_WCOL1_GEN1A 34.5 0.69 2.5 5.0 1.5 0.008
TRANSFORMER WINDCOL1 WINDGEN1B TR_WCOL1_GEN1B 34.5 0.69 2.5 5.0 1.5 0.008
TRANSFORMER WINDCOL1 WINDGEN1C TR_WCOL1_GEN1C 34.5 0.69 2.5 5.0 1.5 0.008
TRANSFORMER WINDCOL2 WINDGEN2A TR_WCOL2_GEN2A 34.5 0.69 3.0 5.2 1.45 0.0078
TRANSFORMER WINDCOL2 WINDGEN2B TR_WCOL2_GEN2B 34.5 0.69 3.0 5.2 1.45 0.0078
TRANSFORMER WINDCOL2 WINDGEN2C TR_WCOL2_GEN2C 34.5 0.69 3.0 5.2 1.45 0.0078

# Solar Inverter Step-up Transformers
TRANSFORMER SOLARCOL1 SOLARGEN1A TR_SCOL1_GEN1A 34.5 0.48 2.0 4.8 1.55 0.0085
TRANSFORMER SOLARCOL1 SOLARGEN1B TR_SCOL1_GEN1B 34.5 0.48 2.0 4.8 1.55 0.0085
TRANSFORMER SOLARCOL1 SOLARGEN1C TR_SCOL1_GEN1C 34.5 0.48 2.0 4.8 1.55 0.0085
TRANSFORMER SOLARCOL2 SOLARGEN2A TR_SCOL2_GEN2A 34.5 0.48 1.8 4.5 1.58 0.009
TRANSFORMER SOLARCOL2 SOLARGEN2B TR_SCOL2_GEN2B 34.5 0.48 1.8 4.5 1.58 0.009
TRANSFORMER SOLARCOL2 SOLARGEN2C TR_SCOL2_GEN2C 34.5 0.48 1.8 4.5 1.58 0.009

# Energy Storage and STATCOM Transformers
TRANSFORMER DISTBUS1 STORAGE1 TR_DIST1_STOR1 138.0 13.8 25.0 6.5 1.25 0.0055
TRANSFORMER DISTBUS3 STORAGE2 TR_DIST3_STOR2 138.0 13.8 30.0 6.8 1.22 0.0052
TRANSFORMER DISTBUS2 STATCOM1 TR_DIST2_STAT1 138.0 13.8 40.0 7.0 1.2 0.005
TRANSFORMER DISTBUS5 STATCOM2 TR_DIST5_STAT2 138.0 13.8 35.0 6.9 1.18 0.0048

# Loads: Active power (MW) Reactive power (MVAR) Type (0=constant Z, 1=constant P, 2=constant I)
LOAD DISTBUS1 LOAD_DIST1 45.0 15.0 1
LOAD DISTBUS2 LOAD_DIST2 60.0 18.0 1
LOAD DISTBUS3 LOAD_DIST3 75.0 22.0 1
LOAD DISTBUS4 LOAD_DIST4 50.0 16.0 1
LOAD DISTBUS5 LOAD_DIST5 65.0 20.0 1
LOAD DISTBUS6 LOAD_DIST6 55.0 17.0 1

# Industrial Loads with Dynamic Components
LOAD DISTBUS2 LOAD_IND1 30.0 25.0 2
LOAD DISTBUS5 LOAD_IND2 40.0 30.0 2

[SOURCES]
# Format: Type Node Name Parameters...
# Grid Voltage Sources: Amplitude (kV) Frequency (Hz) Phase (degrees)
VOLTAGE MAINBUS1 GRID1_A 345.0 60.0 0.0
VOLTAGE MAINBUS1 GRID1_B 345.0 60.0 120.0
VOLTAGE MAINBUS1 GRID1_C 345.0 60.0 240.0
VOLTAGE MAINBUS4 GRID2 345.0 60.0 -3.0

# Wind Generators: Voltage(V) Frequency(Hz) P(MW) Q(MVAR) Inertia(s) Type(1=DFIG, 2=PMSG)
WINDGEN WINDGEN1A WTG1A 690.0 60.0 2.0 0.5 4.0 1
WINDGEN WINDGEN1B WTG1B 690.0 60.0 2.0 0.5 4.0 1
WINDGEN WINDGEN1C WTG1C 690.0 60.0 2.0 0.5 4.0 1
WINDGEN WINDGEN2A WTG2A 690.0 60.0 2.5 0.6 4.5 2
WINDGEN WINDGEN2B WTG2B 690.0 60.0 2.5 0.6 4.5 2
WINDGEN WINDGEN2C WTG2C 690.0 60.0 2.5 0.6 4.5 2

# Solar Inverters: Voltage(V) Frequency(Hz) P(MW) Q(MVAR) Type(1=Grid-following, 2=Grid-forming)
SOLARGEN SOLARGEN1A PV1A 480.0 60.0 1.5 0.0 1
SOLARGEN SOLARGEN1B PV1B 480.0 60.0 1.5 0.0 1
SOLARGEN SOLARGEN1C PV1C 480.0 60.0 1.5 0.0 1
SOLARGEN SOLARGEN2A PV2A 480.0 60.0 1.2 0.0 2
SOLARGEN SOLARGEN2B PV2B 480.0 60.0 1.2 0.0 2
SOLARGEN SOLARGEN2C PV2C 480.0 60.0 1.2 0.0 2

# Energy Storage Systems: Voltage(V) Capacity(MWh) Power(MW) SOC(%) Response Time(ms)
STORAGE STORAGE1 BESS1 13800.0 50.0 25.0 85.0 20.0
STORAGE STORAGE2 BESS2 13800.0 75.0 30.0 70.0 15.0

# STATCOM: Voltage(V) Reactive Power Range(MVAR min,max) Response Time(ms)
STATCOM STATCOM1 STAT1 13800.0 -40.0 40.0 10.0
STATCOM STATCOM2 STAT2 13800.0 -35.0 35.0 10.0

# Dynamic Load Models: Components of ZIP model (Z%, I%, P%)
DYNLOAD DISTBUS2 DYLD1 30.0 20.0 50.0
DYNLOAD DISTBUS5 DYLD2 25.0 25.0 50.0

# Faults: Start time (s) Duration (s) Fault resistance (ohm) Type(1=3Ph, 2=SLG, 3=LL, 4=DLG)
FAULT MAINBUS3 FAULT1 0.1 0.05 0.1 1
FAULT DISTBUS4 FAULT2 0.2 0.05 0.5 2

# Surge Arresters: Voltage rating(kV) Energy capability(kJ)
ARRESTER MAINBUS1 ARR1 360.0 1200.0
ARRESTER MAINBUS4 ARR2 360.0 1200.0
ARRESTER DISTBUS1 ARR3 145.0 800.0
ARRESTER DISTBUS4 ARR4 145.0 800.0

# Series Compensation: Location percentage(%) Compensation level(%)
SERIESCOMP LINE2_3 SCOMP1 50.0 70.0
SERIESCOMP LINE6_7 SCOMP2 50.0 65.0

# Shunt Reactors: Voltage(kV) MVAR Rating
SHUNTREACTOR MAINBUS4 SREACT1 345.0 50.0
SHUNTREACTOR MAINBUS6 SREACT2 345.0 45.0

# Shunt Capacitor Banks: Voltage(kV) MVAR Rating Switching steps
SHUNTCAP DISTBUS3 SCAP1 138.0 30.0 3
SHUNTCAP DISTBUS6 SCAP2 138.0 25.0 2

# HVDC Link: From Bus To Bus Name Type(1=LCC, 2=VSC) Power(MW) Voltage(kV)
HVDC MAINBUS1 MAINBUS4 HVDC1 2 500.0 400.0

[SIMULATION]
# General simulation parameters
TIMESTEP 20.0e-6
ENDTIME 0.5
PLOTFREQ 1000
SNAPSHOTFREQ 50
INTEGRATIONMETHOD 1  # 1=Trapezoidal, 2=Gear

[ANALYSES]
# Types of analyses to perform
# Steady-State, Time-Domain, Frequency Scan, Harmonic Analysis
TYPE TIME-DOMAIN
FAULT-ENABLE 1
DYNAMICS-ENABLE 1
HARMONICS-ENABLE 0

[OUTPUT]
# Output control
VERBOSE 1
PLOT-BUS MAINBUS1 MAINBUS3 MAINBUS5 DISTBUS1 DISTBUS3 DISTBUS5 WINDCOL1 SOLARCOL1
PLOT-BRANCH LINE1_2 LINE3_4 LINE6_7 DIST2_3 DIST5_6
PLOT-TRANSFORMER TR_MAIN1_DIST1 TR_DIST1_WCOL1 TR_DIST3_SCOL1
PLOT-FAULT ALL
PLOT-STATCOM ALL
PLOT-STORAGE ALL
PLOT-GEN ALL